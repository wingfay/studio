@{
    ViewBag.Title = "Home Page";
}

<div class="jumbotron">
    <h1>ASP.NET</h1>
    <p class="lead">ASP.NET is a free web framework for building great Web sites and Web applications using HTML, CSS and JavaScript.</p>
    <p><a href="https://asp.net" class="btn btn-primary btn-lg">Learn more &raquo;</a></p>
</div>

<div class="row">
    <div class="col-md-4">

        <script type="text/javascript">
            
            function launchSaveToOneDrive() {


                $.getJSON("@Url.Action("GetBase64", "Home")", { id: 33 }, function (json) {
                    console.log("Data Loaded: " + json);

                    var odOptions = {
                        clientId: "76eac9e6-f38a-4d5f-a88b-38c1f51ddef9",
                        action: "save",
                        sourceInputElementId: "",
                        sourceUri: json,
                        fileName: "cat title.doc",
                        openInNewWindow: true,
                        advanced: {},
                        success: function (files) {
                            console.log(files)
                        },
                        progress: function (p) { console.log(e) },
                        cancel: function () { /* cancel handler */ },
                        error: function (e) { console.log(e); }
                    }

                    OneDrive.save(odOptions);
                });

            }


        function launchOneDrivePicker() {
            var odOptions = {
                clientId: "2b68c072-879f-4c18-b12a-a4719c970c92",
                action: "query",
                multiSelect: true,
                advanced: {},
                success: function (files) { /* success handler */ },
                cancel: function () { /* cancel handler */ },
                error: function (e) { /* error handler */ }
            }
            OneDrive.open(odOptions);
        }
        </script>
        }

        <input id="fileUploadControl" name="fileUploadControl" type="file" />
        <button onclick="launchSaveToOneDrive()">Save to OneDrive</button>

    </div>

</div>